---
name: load-issues
description: ためた issue をまとめて調査・実装
tools: Read, Glob, Grep, Write, Edit, Bash, Task, AskUserQuestion
user_invocable: true
---

# Load Issues（issue 一括調査＆実装）

`.claude/issues/` にためた issue をまとめて調査・具体化し、並列実装する。
issue は曖昧な一言メモなので、plan とは違い「調査 → 具体化」フェーズが必須。

---

## 手順

### Phase 1: 一覧表示

#### 1. issue ファイルの取得

- `.claude/issues/*.md`（ルート直下のみ）を Glob で取得する（`done/` サブディレクトリは対象外）
- ファイルが見つからない場合:
  - 「未対応の issue がありません。`/issue {内容}` で課題を記録してください」と案内して終了

#### 2. issue の読み込み

各ファイルを Read し、タイトル（`#` 見出し）・登録日・ステータスを抽出する（「未対応」のもののみ対象）

#### 3. 一覧表示

```
## 未対応の issue

| # | ファイル名 | 内容 | 登録日 |
|---|-----------|------|--------|
| 1 | {filename} | {title} | {date} |
| 2 | {filename} | {title} | {date} |
```

---

### Phase 2: 実行対象の選択

#### 4. 実行方法の確認

AskUserQuestion で確認する:

- 全て実装（推奨）
- 選択して実装（番号指定）
- 確認のみ（実行せず終了）

「確認のみ」が選択された場合はここで **終了**。

---

### Phase 3: 調査・具体化（plan との最大の違い）

#### 5. 並列調査

選択された各 issue に対して、Task ツール（subagent_type: Explore）で **並列調査** する:

- issue の一言メモから関連ファイル・箇所を特定
- 現状の実装を確認し、何をどう直すべきか具体化
- 変更対象ファイルと修正方針を返す

#### 6. 不明点のヒアリング

調査しても意図が特定できない issue があれば、AskUserQuestion でユーザーに確認する。
（例: 「"ヒント文言が硬い" はどういうトーンにしたいですか？」）
調査で判断できた issue はスキップ。

#### 7. 調査結果の表示

```
## 調査結果

| # | issue | 変更対象 | 修正方針 |
|---|-------|---------|---------|
| 1 | {title} | {files} | {approach} |
| 2 | {title} | {files} | {approach} |

## 競合（あれば）
- `path/to/file.js` → issue #1, #3 が同時に変更
```

#### 8. 実装確認

AskUserQuestion で調査結果を確認してもらう:

- この方針で実装する（推奨）
- 修正あり（フィードバック後に再計画）
- 中止

---

### Phase 4: 実装

#### 9. 並列実装

`.tpi` パターンで並列実装する（メインは調整役のみ、実装はサブエージェントに委譲）:

- 各サブエージェントに issue 内容 + 調査結果（変更対象・修正方針）を渡す
- 競合する issue 間には blockedBy を設定する

---

### Phase 5: 完了処理

#### 10. ステータス更新

完了した各 issue ファイルのステータスを Edit で「完了」に更新する

#### 11. done ディレクトリへ移動

- `.claude/issues/done/` ディレクトリがなければ Bash で作成する
- 完了ファイルを Bash の `mv` で `done/` に移動する

#### 12. 結果サマリー

```
## 完了

| # | issue | 結果 |
|---|-------|------|
| 1 | {title} | 完了 |
| 2 | {title} | 完了 |

{件数} 件の issue を処理しました。
```

---

## 禁止事項

- 「完了」ステータスの issue を再処理しない
- 調査フェーズを飛ばして直接実装に入らない（issue は曖昧なため必ず調査が必要）
- 競合する issue を確認なしで並列実装しない
