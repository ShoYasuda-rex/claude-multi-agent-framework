---
name: save-plan
description: 計画を .claude/plans/ に保存
model: haiku
tools: Read, Glob, Write, Bash, AskUserQuestion
user_invocable: true
---

# Save Plan（計画保存）

現在の会話で立てた計画を `{プロジェクトルート}/.claude/plans/` に保存する。

---

## 手順

### 1. 計画内容の抽出

- 会話コンテキストから計画内容を把握する（直前のやり取りからタスク・変更対象ファイル・手順を抽出）
- 以下を整理する:
  - **概要:** 何をする計画か（1-2行）
  - **変更対象ファイル:** 書き込み（Write/Edit）するファイル一覧
  - **参照ファイル:** 読み取り（Read）のみのファイル一覧
  - **実行ステップ:** 具体的な手順（コード変更の内容を含む）
  - **注意事項:** 制約・前提条件があれば

### 2. 概要の確認

AskUserQuestion で1問だけ確認する:

- 「この計画の概要で合っていますか？」（自動抽出した概要を提示。選択: はい / 修正する）

### 3. ディレクトリ準備

- `.claude/plans/` ディレクトリが存在しなければ Bash で作成する

### 4. ファイル名の自動生成

- **名前はユーザーに聞かない。自動で決める**
- フォーマット: `{YYYY-MM-DD}_{HHmm}_{概要の短縮キーワード(英語kebab-case)}.md`
- 例: `2026-02-06_1430_fix-chat-layout.md`
- 日時は現在時刻を Bash の `date` コマンドで取得する: `date +"%Y-%m-%d_%H%M"`
- 概要から英語 kebab-case のキーワードを自動生成する（3-5単語以内）

### 5. ファイル保存

`.claude/plans/{自動生成ファイル名}` に以下のフォーマットで保存する:

```markdown
# {計画の概要タイトル}

- **作成日:** {YYYY-MM-DD HH:mm}
- **ステータス:** 未実行

## 概要
{何をする計画か、1-2行}

## 変更対象ファイル
- path/to/file1.html
- path/to/file2.js

## 参照ファイル
- path/to/ref1.js

## 実行ステップ
1. {具体的な手順（何をどう変えるか）}
2. {具体的な手順}

## 注意事項
- {制約・前提条件}
```

### 6. 完了報告

以下を含めて報告する:
- 保存先パス
- 変更対象ファイル数
- 「別のチャットで `/load-plans` で読み込んで実行できます」の案内

---

## 禁止事項

- ファイル名をユーザーに聞かない（自動生成する）
- 計画の内容を勝手に変えない（会話で合意した内容をそのまま保存する）
- 実行しない（保存のみ。実行は `/load-plans` で行う）
